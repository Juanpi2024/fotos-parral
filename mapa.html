<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mapa Patrimonial Interactivo ‚Äì Archivos en Movimiento</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&family=Merriweather:wght@400;700&family=Playfair+Display:ital,wght@0,400;0,700;1,400&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="style.css">

    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
        integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />

    <style>
        /* ============================================
           MAPA PATRIMONIAL INTERACTIVO - ESTILOS
           ============================================ */

        .mapa-hero {
            background: linear-gradient(180deg, #0a0a0a 0%, #1a1a1a 100%);
            padding: 4rem 1rem 3rem;
            text-align: center;
            position: relative;
        }

        .mapa-hero p {
            color: rgba(255, 255, 255, 0.7);
            font-size: 1rem;
            margin-top: 0.5rem;
            font-family: 'Lato', sans-serif;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        /* Layout Principal */
        .mapa-section {
            display: flex;
            height: calc(100vh - 200px);
            min-height: 600px;
            background: #f5f5f5;
        }

        /* Contenedor del Mapa */
        .mapa-container {
            flex: 1;
            position: relative;
        }

        #mapaPatrimonial {
            width: 100%;
            height: 100%;
            z-index: 1;
        }

        /* Panel Lateral de Informaci√≥n */
        .info-panel {
            width: 400px;
            background: #fff;
            border-left: 1px solid #e0e0e0;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
        }

        .info-panel-header {
            padding: 1.5rem;
            background: linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 100%);
            color: #fff;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .info-panel-header h3 {
            font-family: 'Playfair Display', serif;
            font-size: 1.3rem;
            margin: 0 0 0.25rem 0;
            color: #fff;
        }

        .info-panel-header .category {
            font-size: 0.8rem;
            color: var(--accent-color, #C5A059);
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }

        /* Default State */
        .info-panel-default {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 2rem;
            text-align: center;
            color: #888;
        }

        .info-panel-default .icon {
            font-size: 3rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        .info-panel-default p {
            font-family: 'Lato', sans-serif;
            font-size: 1rem;
            margin: 0;
        }

        /* Contenido del Panel */
        .info-panel-content {
            display: none;
            flex-direction: column;
        }

        .info-panel-content.active {
            display: flex;
        }

        .info-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
        }

        .info-body {
            padding: 1.5rem;
        }

        .info-address {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 1rem;
            font-family: 'Lato', sans-serif;
        }

        .info-address::before {
            content: 'üìç';
        }

        .info-description {
            font-family: 'Lato', sans-serif;
            font-size: 0.95rem;
            line-height: 1.7;
            color: #444;
            margin-bottom: 1.5rem;
        }

        /* Info Meta (a√±o, fotos, etc) */
        .info-meta {
            display: flex;
            gap: 1.5rem;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid #eee;
        }

        .info-meta-item {
            display: flex;
            align-items: center;
            gap: 0.4rem;
            font-size: 0.85rem;
            color: #666;
        }

        /* Bot√≥n Ver Ficha */
        .btn-ficha {
            display: block;
            width: 100%;
            padding: 1rem;
            background: linear-gradient(135deg, var(--accent-color, #C5A059) 0%, #D4AF37 100%);
            color: #1a1a1a;
            text-decoration: none;
            text-align: center;
            font-family: 'Lato', sans-serif;
            font-weight: 700;
            font-size: 0.95rem;
            border-radius: 8px;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .btn-ficha:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(197, 160, 89, 0.4);
        }

        /* Filtros */
        .filtros-container {
            background: #fff;
            padding: 1rem 1.5rem;
            border-bottom: 1px solid #e0e0e0;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            flex-wrap: wrap;
        }

        .filtros-container label {
            font-family: 'Lato', sans-serif;
            font-size: 0.85rem;
            font-weight: 600;
            color: #555;
        }

        .filtro-btn {
            padding: 0.5rem 1rem;
            border: 1px solid #ddd;
            background: #fff;
            border-radius: 20px;
            font-family: 'Lato', sans-serif;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .filtro-btn:hover,
        .filtro-btn.active {
            background: var(--accent-color, #C5A059);
            border-color: var(--accent-color, #C5A059);
            color: #fff;
        }

        /* Cards Inferiores */
        .mapa-cards-section {
            background: #fff;
            padding: 3rem 1rem;
        }

        .mapa-cards-grid {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1.5rem;
        }

        .mapa-card {
            background: #FCFAF7;
            border: 1px solid #e8e4df;
            border-radius: 12px;
            padding: 1.5rem;
            transition: all 0.3s ease;
        }

        .mapa-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
            border-color: var(--accent-color, #C5A059);
        }

        .mapa-card h4 {
            font-family: 'Playfair Display', serif;
            font-size: 1.1rem;
            margin: 0 0 0.75rem 0;
            color: #1a1a1a;
        }

        .mapa-card p {
            font-family: 'Lato', sans-serif;
            font-size: 0.9rem;
            color: #666;
            margin: 0 0 1rem 0;
            line-height: 1.5;
        }

        .mapa-card a {
            color: var(--accent-color, #C5A059);
            text-decoration: none;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .mapa-card a:hover {
            text-decoration: underline;
        }

        /* Marcadores personalizados */
        .custom-marker {
            background: linear-gradient(135deg, #C5A059 0%, #D4AF37 100%);
            border: 3px solid #fff;
            border-radius: 50%;
            width: 32px !important;
            height: 32px !important;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);
            cursor: pointer;
            transition: transform 0.2s ease;
        }

        .custom-marker:hover {
            transform: scale(1.2);
        }

        /* Popup personalizado */
        .leaflet-popup-content-wrapper {
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
        }

        .leaflet-popup-content {
            margin: 12px;
            font-family: 'Lato', sans-serif;
        }

        .popup-title {
            font-family: 'Merriweather', serif;
            font-weight: 700;
            font-size: 1rem;
            margin: 0 0 0.25rem 0;
        }

        .popup-category {
            color: var(--accent-color, #C5A059);
            font-size: 0.75rem;
            text-transform: uppercase;
        }

        /* Responsive */
        @media (max-width: 900px) {
            .mapa-section {
                flex-direction: column;
                height: auto;
            }

            .mapa-container {
                height: 400px;
            }

            .info-panel {
                width: 100%;
                max-height: 400px;
            }

            .mapa-cards-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>

<body>

    <header>
        <div class="container">
            <div class="logo-area">
                <h1><a href="index.html">Archivos en Movimiento</a></h1>
                <p class="subtitle">Patrimonio Vivo de Parral</p>
            </div>
            <button class="mobile-menu-btn" aria-label="Men√∫">
                <span></span>
                <span></span>
                <span></span>
            </button>
            <nav class="main-nav">
                <ul>
                    <li><a href="index.html">Inicio</a></li>
                    <li><a href="galeria.html">Galer√≠a</a></li>
                    <li><a href="relatos.html">Relatos</a></li>
                    <li><a href="educacion.html">Educaci√≥n</a></li>
                    <li><a href="historia.html">Historia</a></li>
                    <li><a href="mapa.html" class="active">Mapa</a></li>
                    <li><a href="participa.html" class="btn-nav">¬°Participa!</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- HERO -->
    <section class="mapa-hero">
        <h1 class="hero-title-dual">
            <span class="title-white">Mapa Patrimonial</span>
            <span class="title-gold">Interactivo</span>
        </h1>
        <p>Recorre la historia de Parral a trav√©s de sus edificios, monumentos y lugares de memoria. Haz clic en los
            hitos para descubrirlos.</p>
    </section>

    <!-- FILTROS -->
    <div class="filtros-container">
        <label>FILTRAR POR:</label>
        <button class="filtro-btn active" data-filter="todos">Todos</button>
        <button class="filtro-btn" data-filter="edificios">Edificios P√∫blicos</button>
        <button class="filtro-btn" data-filter="monumentos">Monumentos</button>
        <button class="filtro-btn" data-filter="memoria">Sitios de Memoria</button>
    </div>

    <!-- MAPA + PANEL -->
    <section class="mapa-section">
        <div class="mapa-container">
            <div id="mapaPatrimonial"></div>
        </div>

        <div class="info-panel">
            <!-- Estado por defecto -->
            <div class="info-panel-default" id="panelDefault">
                <div class="icon">üèõÔ∏è</div>
                <p>Selecciona un sitio en el mapa para ver su informaci√≥n</p>
            </div>

            <!-- Contenido din√°mico -->
            <div class="info-panel-content" id="panelContent">
                <div class="info-panel-header">
                    <span class="category" id="infoCategory">Edificio P√∫blico</span>
                    <h3 id="infoTitle">Teatro Municipal</h3>
                </div>
                <img src="" alt="" class="info-image" id="infoImage">
                <div class="info-body">
                    <div class="info-address" id="infoAddress">Calle Ignacio Carrera Pinto 123, Parral</div>

                    <div class="info-meta">
                        <div class="info-meta-item">
                            <span>üìÖ</span>
                            <span id="infoYear">1920</span>
                        </div>
                        <div class="info-meta-item">
                            <span>üì∑</span>
                            <span id="infoPhotos">5 fotos disponibles</span>
                        </div>
                    </div>

                    <p class="info-description" id="infoDescription">
                        Descripci√≥n del lugar hist√≥rico...
                    </p>

                    <a href="detalle-edificio.html" class="btn-ficha" id="infoLink">
                        Ver Ficha Completa ‚Üí
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- CARDS INFERIORES -->
    <section class="mapa-cards-section">
        <div class="mapa-cards-grid">
            <div class="mapa-card">
                <h4>üì• Rutas Patrimoniales</h4>
                <p>Descarga gu√≠as PDF con recorridos autoguiados por la ciudad.</p>
                <a href="#">Ver rutas ‚Üí</a>
            </div>
            <div class="mapa-card">
                <h4>üì§ Colabora</h4>
                <p>¬øTienes fotos antiguas de Parral? ¬°Ay√∫danos a construir el archivo!</p>
                <a href="participa.html">Subir material ‚Üí</a>
            </div>
            <div class="mapa-card">
                <h4>üéì Visitas Guiadas</h4>
                <p>Agenda una visita educativa para tu colegio o grupo.</p>
                <a href="#">Agendar ‚Üí</a>
            </div>
        </div>
    </section>

    <footer>
        <div class="container">
            <p>&copy; 2025 Archivos en Movimiento. Patrimonio Vivo de Parral.</p>
        </div>
    </footer>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
        integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>

    <script>
        // ============================================
        // BASE DE DATOS DE SITIOS PATRIMONIALES
        // ============================================
        const sitiosPatrimoniales = [
            {
                id: 'teatro-municipal',
                nombre: 'Teatro Municipal',
                categoria: 'edificios',
                categoriaLabel: 'Edificio P√∫blico',
                lat: -36.1398,
                lng: -71.8265,
                direccion: 'Calle Ignacio Carrera Pinto, Parral',
                ano: '1921',
                fotos: 3,
                imagen: 'images/ecos-cultura.jpg',
                descripcion: 'Inaugurado en 1921, el Teatro Municipal de Parral ha sido el epicentro de la vida cultural de la comuna. Su arquitectura neocl√°sica tard√≠a es uno de los pocos edificios originales restaurados tras el terremoto de 2010.',
                link: 'detalle-edificio.html?id=teatro-municipal'
            },
            {
                id: 'casa-neruda',
                nombre: 'Casa Natal de Pablo Neruda',
                categoria: 'monumentos',
                categoriaLabel: 'Monumento Nacional',
                lat: -36.1385,
                lng: -71.8312,
                direccion: 'Calle Arturo Prat, Parral',
                ano: '1904',
                fotos: 8,
                imagen: 'images/ecos-neruda-nace.jpg',
                descripcion: 'En esta modesta casa de madera naci√≥ el 12 de julio de 1904 Ricardo Eli√©cer Neftal√≠ Reyes Basoalto, quien se convertir√≠a en Pablo Neruda, Premio Nobel de Literatura 1971.',
                link: 'detalle-edificio.html?id=casa-neruda'
            },
            {
                id: 'plaza-armas',
                nombre: 'Plaza de Armas',
                categoria: 'monumentos',
                categoriaLabel: 'Espacio P√∫blico',
                lat: -36.1401,
                lng: -71.8271,
                direccion: 'Centro de Parral',
                ano: '1795',
                fotos: 12,
                imagen: 'img/plaza-original.jpg',
                descripcion: 'Coraz√≥n c√≠vico de Parral desde su fundaci√≥n en 1795. La plaza ha sido testigo de todos los acontecimientos importantes de la ciudad, desde celebraciones patrias hasta manifestaciones ciudadanas.',
                link: 'detalle-edificio.html?id=plaza-armas'
            },
            {
                id: 'estacion-ferrocarril',
                nombre: 'Antigua Estaci√≥n de Ferrocarriles',
                categoria: 'edificios',
                categoriaLabel: 'Patrimonio Industrial',
                lat: -36.1425,
                lng: -71.8198,
                direccion: 'Av. Ferrocarril, Parral',
                ano: '1874',
                fotos: 6,
                imagen: 'images/ecos-estacion.jpg',
                descripcion: 'La llegada del ferrocarril transform√≥ a Parral conect√°ndolo con el resto del pa√≠s. Esta estaci√≥n fue testigo de la partida de cientos de parralinos hacia nuevos destinos.',
                link: 'detalle-edificio.html?id=estacion-ferrocarril'
            },
            {
                id: 'puente-perquilauquen',
                nombre: 'Puente Perquilauqu√©n',
                categoria: 'monumentos',
                categoriaLabel: 'Patrimonio Industrial',
                lat: -36.0892,
                lng: -71.8456,
                direccion: 'R√≠o Perquilauqu√©n, Ruta 5 Sur',
                ano: '1896',
                fotos: 4,
                imagen: 'images/ecos-puente.jpg',
                descripcion: 'Majestuoso puente de acero inaugurado en 1896, un gigante de la ingenier√≠a que se convirti√≥ en s√≠mbolo de progreso y conectividad de la zona.',
                link: 'detalle-edificio.html?id=puente-perquilauquen'
            },
            {
                id: 'villa-baviera',
                nombre: 'Villa Baviera (Ex Colonia Dignidad)',
                categoria: 'memoria',
                categoriaLabel: 'Sitio de Memoria',
                lat: -36.4567,
                lng: -71.5234,
                direccion: 'Camino a Bullileo, Parral',
                ano: '1961',
                fotos: 10,
                imagen: 'images/ecos-villa-baviera.jpg',
                descripcion: 'Antiguo enclave alem√°n fundado en 1961, declarado Sitio de Memoria por las graves violaciones a los derechos humanos ocurridas durante la dictadura. Hoy es un espacio de reflexi√≥n y turismo.',
                link: 'detalle-edificio.html?id=villa-baviera'
            },
            {
                id: 'bomberos',
                nombre: 'Cuartel de Bomberos',
                categoria: 'edificios',
                categoriaLabel: 'Edificio P√∫blico',
                lat: -36.1392,
                lng: -71.8285,
                direccion: 'Calle Manuel Rodr√≠guez, Parral',
                ano: '1925',
                fotos: 5,
                imagen: 'images/parral-bomberos-1.jpg',
                descripcion: 'El Cuerpo de Bomberos de Parral, fundado a principios del siglo XX, ha sido pilar fundamental de la comunidad. Su cuartel hist√≥rico es testimonio de la solidaridad parralina.',
                link: 'detalle-edificio.html?id=bomberos'
            },
            {
                id: 'iglesia-parroquia',
                nombre: 'Iglesia Parroquial',
                categoria: 'edificios',
                categoriaLabel: 'Patrimonio Religioso',
                lat: -36.1395,
                lng: -71.8268,
                direccion: 'Plaza de Armas, Parral',
                ano: '1850',
                fotos: 7,
                imagen: 'images/ecos-cultura.jpg',
                descripcion: 'La iglesia parroquial de Parral ha sido el centro espiritual de la comunidad desde mediados del siglo XIX. Su arquitectura refleja la evoluci√≥n de los estilos tras cada terremoto.',
                link: 'detalle-edificio.html?id=iglesia-parroquia'
            }
        ];

        // ============================================
        // INICIALIZACI√ìN DEL MAPA
        // ============================================
        const mapa = L.map('mapaPatrimonial').setView([-36.1398, -71.8265], 14);

        // Capa base - Estilo elegante
        L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',
            subdomains: 'abcd',
            maxZoom: 19
        }).addTo(mapa);

        // Marcadores personalizados
        const marcadores = {};

        function crearMarcador(sitio) {
            const iconoDorado = L.divIcon({
                className: 'custom-marker',
                html: getIcono(sitio.categoria),
                iconSize: [32, 32],
                iconAnchor: [16, 16]
            });

            const marcador = L.marker([sitio.lat, sitio.lng], { icon: iconoDorado })
                .addTo(mapa)
                .bindPopup(`
                    <div>
                        <p class="popup-title">${sitio.nombre}</p>
                        <p class="popup-category">${sitio.categoriaLabel}</p>
                    </div>
                `);

            marcador.on('click', () => mostrarInfoPanel(sitio));
            marcador.sitioData = sitio;
            marcadores[sitio.id] = marcador;
        }

        function getIcono(categoria) {
            switch (categoria) {
                case 'edificios': return 'üèõÔ∏è';
                case 'monumentos': return 'üóø';
                case 'memoria': return 'üïØÔ∏è';
                default: return 'üìç';
            }
        }

        // Crear todos los marcadores
        sitiosPatrimoniales.forEach(sitio => crearMarcador(sitio));

        // ============================================
        // PANEL DE INFORMACI√ìN
        // ============================================
        function mostrarInfoPanel(sitio) {
            document.getElementById('panelDefault').style.display = 'none';
            document.getElementById('panelContent').classList.add('active');

            document.getElementById('infoCategory').textContent = sitio.categoriaLabel;
            document.getElementById('infoTitle').textContent = sitio.nombre;
            document.getElementById('infoImage').src = sitio.imagen;
            document.getElementById('infoImage').alt = sitio.nombre;
            document.getElementById('infoAddress').textContent = sitio.direccion;
            document.getElementById('infoYear').textContent = sitio.ano;
            document.getElementById('infoPhotos').textContent = `${sitio.fotos} fotos disponibles`;
            document.getElementById('infoDescription').textContent = sitio.descripcion;
            document.getElementById('infoLink').href = sitio.link;
        }

        // ============================================
        // FILTROS
        // ============================================
        document.querySelectorAll('.filtro-btn').forEach(btn => {
            btn.addEventListener('click', function () {
                // Update active state
                document.querySelectorAll('.filtro-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');

                const filtro = this.dataset.filter;

                Object.values(marcadores).forEach(marcador => {
                    const categoria = marcador.sitioData.categoria;
                    if (filtro === 'todos' || categoria === filtro) {
                        marcador.addTo(mapa);
                    } else {
                        mapa.removeLayer(marcador);
                    }
                });
            });
        });

        // ============================================
        // MEN√ö M√ìVIL
        // ============================================
        document.querySelector('.mobile-menu-btn').addEventListener('click', function () {
            document.querySelector('.main-nav').classList.toggle('show');
        });
    </script>
</body>

</html>